eval_it_pool:  [0, 500, 1000]

================== Exp 0 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'pre_processed_mnist', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 1, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': '/home/daniel/exjobb/Transfer-Learning-Library/examples/domain_adaptation/image_classification/data/pre_cond/digits', 'save_path': 'result', 'dis_metric': 'ours', 'domain_adaptation': 'True', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f191d4811d0>, 'dsa': False}
Evaluation model pool:  ['ConvNet']
class c = 0: 4729 real images
class c = 1: 5470 real images
class c = 2: 4762 real images
class c = 3: 4889 real images
class c = 4: 4655 real images
class c = 5: 4324 real images
class c = 6: 4748 real images
class c = 7: 4968 real images
class c = 8: 4653 real images
class c = 9: 4802 real images
real images channel 0, mean = 0.1290, std = 0.3064
initialize synthetic data from random noise
[2023-04-23 02:02:42] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
[2023-04-23 02:02:56] Evaluate_00: epoch = 0300 train time = 9 s train loss = 0.004235 train acc = 1.0000, test acc = 0.0932
[2023-04-23 02:03:10] Evaluate_01: epoch = 0300 train time = 8 s train loss = 0.004119 train acc = 1.0000, test acc = 0.1208
[2023-04-23 02:03:24] Evaluate_02: epoch = 0300 train time = 8 s train loss = 0.004270 train acc = 1.0000, test acc = 0.0921
[2023-04-23 02:03:37] Evaluate_03: epoch = 0300 train time = 8 s train loss = 0.004161 train acc = 1.0000, test acc = 0.1128
[2023-04-23 02:03:51] Evaluate_04: epoch = 0300 train time = 8 s train loss = 0.004188 train acc = 1.0000, test acc = 0.0886
[2023-04-23 02:04:04] Evaluate_05: epoch = 0300 train time = 8 s train loss = 0.004280 train acc = 1.0000, test acc = 0.1047
[2023-04-23 02:04:18] Evaluate_06: epoch = 0300 train time = 8 s train loss = 0.004209 train acc = 1.0000, test acc = 0.1048
[2023-04-23 02:04:31] Evaluate_07: epoch = 0300 train time = 8 s train loss = 0.004120 train acc = 1.0000, test acc = 0.1149
[2023-04-23 02:04:44] Evaluate_08: epoch = 0300 train time = 8 s train loss = 0.004135 train acc = 1.0000, test acc = 0.1002
[2023-04-23 02:04:58] Evaluate_09: epoch = 0300 train time = 8 s train loss = 0.004119 train acc = 1.0000, test acc = 0.0965
[2023-04-23 02:05:11] Evaluate_10: epoch = 0300 train time = 8 s train loss = 0.004062 train acc = 1.0000, test acc = 0.1209
[2023-04-23 02:05:25] Evaluate_11: epoch = 0300 train time = 8 s train loss = 0.004194 train acc = 1.0000, test acc = 0.1057
[2023-04-23 02:05:38] Evaluate_12: epoch = 0300 train time = 8 s train loss = 0.004146 train acc = 1.0000, test acc = 0.1237
[2023-04-23 02:05:52] Evaluate_13: epoch = 0300 train time = 8 s train loss = 0.004023 train acc = 1.0000, test acc = 0.1044
[2023-04-23 02:06:06] Evaluate_14: epoch = 0300 train time = 8 s train loss = 0.004251 train acc = 1.0000, test acc = 0.0704
[2023-04-23 02:06:19] Evaluate_15: epoch = 0300 train time = 8 s train loss = 0.004241 train acc = 1.0000, test acc = 0.1129
[2023-04-23 02:06:33] Evaluate_16: epoch = 0300 train time = 8 s train loss = 0.004113 train acc = 1.0000, test acc = 0.1089
[2023-04-23 02:06:46] Evaluate_17: epoch = 0300 train time = 8 s train loss = 0.004089 train acc = 1.0000, test acc = 0.1168
[2023-04-23 02:07:00] Evaluate_18: epoch = 0300 train time = 8 s train loss = 0.004313 train acc = 1.0000, test acc = 0.0915
[2023-04-23 02:07:13] Evaluate_19: epoch = 0300 train time = 8 s train loss = 0.004118 train acc = 1.0000, test acc = 0.0509
Evaluate 20 random ConvNet, mean = 0.1017 std = 0.0173
-------------------------
[2023-04-23 02:07:36] iter = 0000, loss = 244.5035
[2023-04-23 02:11:18] iter = 0010, loss = 104.5630
[2023-04-23 02:15:01] iter = 0020, loss = 91.0568
[2023-04-23 02:18:44] iter = 0030, loss = 74.6934
[2023-04-23 02:22:27] iter = 0040, loss = 68.8572
[2023-04-23 02:26:10] iter = 0050, loss = 62.6985
[2023-04-23 02:29:53] iter = 0060, loss = 57.1706
[2023-04-23 02:33:37] iter = 0070, loss = 55.4144
[2023-04-23 02:37:22] iter = 0080, loss = 51.9854
[2023-04-23 02:41:05] iter = 0090, loss = 49.9811
[2023-04-23 02:44:48] iter = 0100, loss = 49.9315
[2023-04-23 02:48:31] iter = 0110, loss = 48.5641
[2023-04-23 02:52:15] iter = 0120, loss = 49.7580
[2023-04-23 02:55:58] iter = 0130, loss = 48.0014
[2023-04-23 02:59:41] iter = 0140, loss = 47.6963
[2023-04-23 03:03:25] iter = 0150, loss = 49.1622
[2023-04-23 03:07:08] iter = 0160, loss = 45.8973
[2023-04-23 03:10:52] iter = 0170, loss = 46.9618
[2023-04-23 03:14:35] iter = 0180, loss = 47.5653
[2023-04-23 03:18:18] iter = 0190, loss = 44.5884
[2023-04-23 03:22:01] iter = 0200, loss = 44.5844
[2023-04-23 03:25:45] iter = 0210, loss = 46.2588
[2023-04-23 03:29:28] iter = 0220, loss = 43.6939
[2023-04-23 03:33:12] iter = 0230, loss = 45.3504
[2023-04-23 03:36:55] iter = 0240, loss = 43.3541
[2023-04-23 03:40:38] iter = 0250, loss = 45.2209
[2023-04-23 03:44:22] iter = 0260, loss = 46.6529
[2023-04-23 03:48:06] iter = 0270, loss = 43.6065
[2023-04-23 03:51:52] iter = 0280, loss = 40.6076
[2023-04-23 03:55:35] iter = 0290, loss = 44.1166
[2023-04-23 03:59:18] iter = 0300, loss = 44.5862
[2023-04-23 04:03:03] iter = 0310, loss = 43.0257
[2023-04-23 04:06:48] iter = 0320, loss = 46.2016
[2023-04-23 04:10:33] iter = 0330, loss = 47.0208
[2023-04-23 04:14:17] iter = 0340, loss = 43.7462
[2023-04-23 04:18:04] iter = 0350, loss = 42.0976
[2023-04-23 04:21:48] iter = 0360, loss = 43.3276
[2023-04-23 04:25:31] iter = 0370, loss = 43.4721
[2023-04-23 04:29:15] iter = 0380, loss = 45.3696
[2023-04-23 04:32:59] iter = 0390, loss = 42.0992
[2023-04-23 04:36:42] iter = 0400, loss = 43.9651
[2023-04-23 04:40:26] iter = 0410, loss = 41.8422
[2023-04-23 04:44:10] iter = 0420, loss = 44.4468
[2023-04-23 04:47:53] iter = 0430, loss = 43.9213
[2023-04-23 04:51:37] iter = 0440, loss = 43.6516
[2023-04-23 04:55:21] iter = 0450, loss = 42.5979
[2023-04-23 04:59:05] iter = 0460, loss = 43.9756
[2023-04-23 05:02:48] iter = 0470, loss = 43.3012
[2023-04-23 05:06:34] iter = 0480, loss = 41.0164
[2023-04-23 05:10:18] iter = 0490, loss = 43.6911
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
[2023-04-23 05:13:54] Evaluate_00: epoch = 0300 train time = 8 s train loss = 0.007296 train acc = 1.0000, test acc = 0.9553
[2023-04-23 05:14:08] Evaluate_01: epoch = 0300 train time = 8 s train loss = 0.007571 train acc = 1.0000, test acc = 0.9553
[2023-04-23 05:14:21] Evaluate_02: epoch = 0300 train time = 8 s train loss = 0.007235 train acc = 1.0000, test acc = 0.9568
[2023-04-23 05:14:35] Evaluate_03: epoch = 0300 train time = 8 s train loss = 0.007565 train acc = 1.0000, test acc = 0.9559
[2023-04-23 05:14:49] Evaluate_04: epoch = 0300 train time = 8 s train loss = 0.007363 train acc = 1.0000, test acc = 0.9573
[2023-04-23 05:15:02] Evaluate_05: epoch = 0300 train time = 8 s train loss = 0.007333 train acc = 1.0000, test acc = 0.9565
[2023-04-23 05:15:16] Evaluate_06: epoch = 0300 train time = 8 s train loss = 0.007471 train acc = 1.0000, test acc = 0.9562
[2023-04-23 05:15:30] Evaluate_07: epoch = 0300 train time = 8 s train loss = 0.007287 train acc = 1.0000, test acc = 0.9569
[2023-04-23 05:15:43] Evaluate_08: epoch = 0300 train time = 8 s train loss = 0.007847 train acc = 1.0000, test acc = 0.9572
[2023-04-23 05:15:57] Evaluate_09: epoch = 0300 train time = 8 s train loss = 0.007583 train acc = 1.0000, test acc = 0.9554
[2023-04-23 05:16:11] Evaluate_10: epoch = 0300 train time = 8 s train loss = 0.007575 train acc = 1.0000, test acc = 0.9568
[2023-04-23 05:16:24] Evaluate_11: epoch = 0300 train time = 8 s train loss = 0.007098 train acc = 1.0000, test acc = 0.9566
[2023-04-23 05:16:38] Evaluate_12: epoch = 0300 train time = 8 s train loss = 0.007127 train acc = 1.0000, test acc = 0.9574
[2023-04-23 05:16:51] Evaluate_13: epoch = 0300 train time = 8 s train loss = 0.007345 train acc = 1.0000, test acc = 0.9583
[2023-04-23 05:17:05] Evaluate_14: epoch = 0300 train time = 8 s train loss = 0.006979 train acc = 1.0000, test acc = 0.9573
[2023-04-23 05:17:19] Evaluate_15: epoch = 0300 train time = 8 s train loss = 0.007114 train acc = 1.0000, test acc = 0.9572
[2023-04-23 05:17:32] Evaluate_16: epoch = 0300 train time = 8 s train loss = 0.007121 train acc = 1.0000, test acc = 0.9583
[2023-04-23 05:17:46] Evaluate_17: epoch = 0300 train time = 8 s train loss = 0.007205 train acc = 1.0000, test acc = 0.9580
[2023-04-23 05:18:00] Evaluate_18: epoch = 0300 train time = 8 s train loss = 0.007373 train acc = 1.0000, test acc = 0.9568
[2023-04-23 05:18:13] Evaluate_19: epoch = 0300 train time = 8 s train loss = 0.007241 train acc = 1.0000, test acc = 0.9551
Evaluate 20 random ConvNet, mean = 0.9567 std = 0.0009
-------------------------
[2023-04-23 05:18:35] iter = 0500, loss = 41.1035
[2023-04-23 05:22:19] iter = 0510, loss = 44.7349
[2023-04-23 05:26:04] iter = 0520, loss = 42.3916
[2023-04-23 05:29:49] iter = 0530, loss = 43.7764
[2023-04-23 05:33:33] iter = 0540, loss = 42.0980
[2023-04-23 05:37:16] iter = 0550, loss = 44.8518
[2023-04-23 05:41:00] iter = 0560, loss = 40.7664
[2023-04-23 05:44:44] iter = 0570, loss = 40.6349
[2023-04-23 05:48:27] iter = 0580, loss = 42.3225
[2023-04-23 05:52:11] iter = 0590, loss = 41.4519
[2023-04-23 05:55:54] iter = 0600, loss = 39.8768
[2023-04-23 05:59:37] iter = 0610, loss = 45.4007
[2023-04-23 06:03:20] iter = 0620, loss = 40.8782
[2023-04-23 06:07:04] iter = 0630, loss = 43.8538
[2023-04-23 06:10:47] iter = 0640, loss = 41.2066
[2023-04-23 06:14:31] iter = 0650, loss = 43.2936
[2023-04-23 06:18:14] iter = 0660, loss = 43.3984
[2023-04-23 06:21:57] iter = 0670, loss = 42.6686
[2023-04-23 06:25:41] iter = 0680, loss = 40.6991
[2023-04-23 06:29:25] iter = 0690, loss = 44.0468
[2023-04-23 06:33:08] iter = 0700, loss = 43.7355
[2023-04-23 06:36:51] iter = 0710, loss = 44.9908
[2023-04-23 06:40:35] iter = 0720, loss = 41.2945
[2023-04-23 06:44:18] iter = 0730, loss = 43.9678
[2023-04-23 06:48:01] iter = 0740, loss = 42.9242
[2023-04-23 06:51:45] iter = 0750, loss = 44.3022
[2023-04-23 06:55:28] iter = 0760, loss = 44.0924
[2023-04-23 06:59:14] iter = 0770, loss = 42.3578
[2023-04-23 07:02:57] iter = 0780, loss = 42.6431
[2023-04-23 07:06:40] iter = 0790, loss = 45.3029
[2023-04-23 07:10:23] iter = 0800, loss = 41.5397
[2023-04-23 07:14:07] iter = 0810, loss = 40.8631
[2023-04-23 07:17:51] iter = 0820, loss = 43.2431
[2023-04-23 07:21:35] iter = 0830, loss = 41.2744
[2023-04-23 07:25:17] iter = 0840, loss = 41.2416
[2023-04-23 07:29:00] iter = 0850, loss = 40.5730
[2023-04-23 07:32:43] iter = 0860, loss = 42.4804
[2023-04-23 07:36:26] iter = 0870, loss = 40.8109
[2023-04-23 07:40:09] iter = 0880, loss = 41.5152
[2023-04-23 07:43:52] iter = 0890, loss = 41.5634
[2023-04-23 07:47:35] iter = 0900, loss = 43.0611
[2023-04-23 07:51:18] iter = 0910, loss = 42.2869
[2023-04-23 07:55:01] iter = 0920, loss = 41.1990
[2023-04-23 07:58:44] iter = 0930, loss = 43.2902
[2023-04-23 08:02:27] iter = 0940, loss = 41.8099
[2023-04-23 08:06:10] iter = 0950, loss = 42.4730
[2023-04-23 08:09:53] iter = 0960, loss = 41.5430
[2023-04-23 08:13:36] iter = 0970, loss = 42.4043
[2023-04-23 08:17:18] iter = 0980, loss = 40.3943
[2023-04-23 08:21:01] iter = 0990, loss = 42.2839
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
[2023-04-23 08:24:36] Evaluate_00: epoch = 0300 train time = 8 s train loss = 0.007503 train acc = 1.0000, test acc = 0.9611
[2023-04-23 08:24:50] Evaluate_01: epoch = 0300 train time = 8 s train loss = 0.008311 train acc = 1.0000, test acc = 0.9587
[2023-04-23 08:25:03] Evaluate_02: epoch = 0300 train time = 8 s train loss = 0.008078 train acc = 1.0000, test acc = 0.9567
[2023-04-23 08:25:17] Evaluate_03: epoch = 0300 train time = 8 s train loss = 0.008184 train acc = 1.0000, test acc = 0.9583
[2023-04-23 08:25:31] Evaluate_04: epoch = 0300 train time = 8 s train loss = 0.008161 train acc = 1.0000, test acc = 0.9597
[2023-04-23 08:25:45] Evaluate_05: epoch = 0300 train time = 8 s train loss = 0.007681 train acc = 1.0000, test acc = 0.9583
[2023-04-23 08:25:58] Evaluate_06: epoch = 0300 train time = 8 s train loss = 0.007433 train acc = 1.0000, test acc = 0.9598
[2023-04-23 08:26:12] Evaluate_07: epoch = 0300 train time = 8 s train loss = 0.007356 train acc = 1.0000, test acc = 0.9604
[2023-04-23 08:26:26] Evaluate_08: epoch = 0300 train time = 8 s train loss = 0.007595 train acc = 1.0000, test acc = 0.9595
[2023-04-23 08:26:39] Evaluate_09: epoch = 0300 train time = 8 s train loss = 0.007558 train acc = 1.0000, test acc = 0.9578
[2023-04-23 08:26:53] Evaluate_10: epoch = 0300 train time = 8 s train loss = 0.007620 train acc = 1.0000, test acc = 0.9587
[2023-04-23 08:27:06] Evaluate_11: epoch = 0300 train time = 8 s train loss = 0.007646 train acc = 1.0000, test acc = 0.9603
[2023-04-23 08:27:20] Evaluate_12: epoch = 0300 train time = 8 s train loss = 0.007614 train acc = 1.0000, test acc = 0.9585
[2023-04-23 08:27:34] Evaluate_13: epoch = 0300 train time = 8 s train loss = 0.008176 train acc = 1.0000, test acc = 0.9577
[2023-04-23 08:27:47] Evaluate_14: epoch = 0300 train time = 8 s train loss = 0.007630 train acc = 1.0000, test acc = 0.9595
[2023-04-23 08:28:01] Evaluate_15: epoch = 0300 train time = 8 s train loss = 0.008365 train acc = 1.0000, test acc = 0.9584
[2023-04-23 08:28:15] Evaluate_16: epoch = 0300 train time = 8 s train loss = 0.008212 train acc = 1.0000, test acc = 0.9599
[2023-04-23 08:28:28] Evaluate_17: epoch = 0300 train time = 8 s train loss = 0.007616 train acc = 1.0000, test acc = 0.9578
[2023-04-23 08:28:42] Evaluate_18: epoch = 0300 train time = 8 s train loss = 0.007830 train acc = 1.0000, test acc = 0.9577
[2023-04-23 08:28:55] Evaluate_19: epoch = 0300 train time = 8 s train loss = 0.007674 train acc = 1.0000, test acc = 0.9594
Evaluate 20 random ConvNet, mean = 0.9589 std = 0.0011
-------------------------
[2023-04-23 08:29:17] iter = 1000, loss = 41.5151

==================== Final Results ====================

Run 1 experiments, train on ConvNet, evaluate 20 random ConvNet, mean  = 95.89%  std = 0.11%
